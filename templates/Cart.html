<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Cart</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='Cart.css') }}">
    <script src="{{ url_for('static', filename='Cart.js') }}"></script>
    <link rel="icon" href="{{ url_for('static', filename='tabicon.png') }}" type="image/png">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Anton&family=Italianno&family=Lobster&display=swap" rel="stylesheet">
</head>
<body>

<div class="navbar">
    <div class="logo">
        <a href="/"><img src="{{ url_for('static', filename='logo.png') }}"></a>
    </div>
    <nav>
        <ul>
            <li><a href="{{ url_for('home') }}">Home</a></li>
            <li><a href="{{ url_for('shops') }}">Shops</a></li>
            <li><a href="{{ url_for('cart') }}">Cart</a></li>
            {% if session.get('user_id') %}
                {% if session.get('user_type') == 'admin' %}
                    <li><a href="{{ url_for('admin') }}">Admin Dashboard</a></li>
                {% endif %}
                <li><a href="{{ url_for('logout') }}" onclick="return confirm('Are you sure you want to Log-Out?')">Logout</a>
                </li>
            {% else %}
                <li><a href="{{ url_for('login') }}">Login/Register</a></li>
            {% endif %}
            <li style="color:#fff; font-size:22px;">Hello! {{ session.get('name', 'User') }}</li>
        </ul>
    </nav>
</div>

<div class="cart-wrapper">

    <div class="left-cart">
        {% if cart_items %}
            {% for item in cart_items %}
                <div class="cart-box">

                    <div class="food-img">
                        <img src="{{ url_for('static', filename='uploads/' ~ item.product_img) }}">
                    </div>

                    <div class="food-info-horizontal">
                        <span><b>Name:</b> {{ item.product_name }}</span>
                        <span><b>Price:</b> ₱{{ item.price }}</span>

                        <span><b>Quantity:</b>
                            <input type="number" class="qty-input"
                                   data-id="{{ item.unique_id }}"
                                   data-price="{{ item.price }}"
                                   min="1" max="10"
                                   value="{{ item.quantity }}">
                        </span>
                    </div>

                    <form class="remove-form" action="{{ url_for('remove_cart_item') }}" method="POST">
                        <input type="hidden" name="product_id" value="{{ item.product_id }}">
                        <input type="hidden" name="shop_table" value="{{ item.shop_table }}">
                        <button class="remove-btn">Remove</button>
                    </form>

                </div>
            {% endfor %}
        {% else %}
            <p style="font-size: 26px;">Your cart is empty!</p>
        {% endif %}
    </div>

    {% if cart_items %}
    <div class="order-summary">

        <h2>Order Summary</h2>

        {% for item in cart_items %}
            <div class="summary-row" id="summary-{{ item.unique_id }}">
                <span>{{ item.product_name }}</span>
                <span>Qty: <span class="summary-qty">{{ item.quantity }}</span></span>
                <span>₱<span class="item-total">{{ item.price * item.quantity }}</span></span>
            </div>
        {% endfor %}

        <hr class="divider">

        <div class="summary-total" id="grand-total">
            <span><b>Total:</b></span>
            <span><b>₱{{ total_price }}</b></span>
        </div>

        <a href="{{ url_for('checkout') }}">
            <button class="checkout-btn">Check-out</button>
        </a>
    </div>
    {% endif %}
</div>

</body>
</html>
